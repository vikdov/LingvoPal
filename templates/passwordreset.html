<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LingvoPal - Reset Password</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" type="image/png" href="img/favicons/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/svg+xml" href="img/favicons/favicon.svg" />
    <link rel="shortcut icon" href="img/favicons/favicon.ico" />
    <link rel="apple-touch-icon" sizes="180x180" href="img/favicons/apple-touch-icon.png" />
    <link rel="manifest" href="img/favicons/site.webmanifest" />
    <style>
        .error-message {
            color: red;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <div class="language-selector">
        <select>
            <option value="en">English</option>
            <option value="pl">Polski</option>
            <option value="de">Deutsch</option>
        </select>
    </div>

    <div class="container">
        <div class="logo">
            <h1>Lingv<span><img class="globe" src="img/globe_final.png" alt=""></span><span>Pal</span></h1>
            <p>Your language learning companion</p>
        </div>

        <!-- Step 1: Enter Email -->
        <form id="reset-step-1">
            <h2>Reset Your Password</h2>
            <div class="form-group">
                <label for="reset-email">Enter your email</label>
                <input type="email" id="reset-email" placeholder="Enter your email" required>
                <div id="error-message" class="error-message"></div>
            </div>
            <button type="button" onclick="goToStep2()">Send Reset Link</button>
            <div class="login-link">
                Remembered your password? <a href="login.html">Go back to login</a>
            </div>
        </form>

        <!-- Step 2: Confirmation Message -->
        <div id="reset-step-2" style="display: none;">
            <h2>Check Your Email</h2>
            <p>Weâ€™ve sent you an email with a link to change your password.</p>
            <button onclick="window.location.href='login.html'">Back to Login</button>
        </div>
    </div>

    <script>
        function isValidEmail(email) {
            const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return emailPattern.test(email);
        }

        function userExists(email) {
            // Dummy validation. Replace with actual fetch or DB check in production.
            const existingUsers = ["test@example.com", "john@domain.com", "viktor@lingvopal.com"];
            return existingUsers.includes(email.toLowerCase());
        }

        function goToStep2() {
            const emailInput = document.getElementById('reset-email');
            const errorMessage = document.getElementById('error-message');
            const step1 = document.getElementById('reset-step-1');
            const step2 = document.getElementById('reset-step-2');

            const email = emailInput.value.trim();
            errorMessage.textContent = "";

            try {
                if (email === "") {
                    errorMessage.textContent = "Please enter your email address.";
                    return;
                }

                if (!isValidEmail(email)) {
                    errorMessage.textContent = "Please enter a valid email address.";
                    return;
                }

                if (!userExists(email)) {
                    errorMessage.textContent = "User with this email does not exist.";
                    return;
                }

                // If everything is OK:
                step1.style.display = "none";
                step2.style.display = "block";
            } catch (error) {
                errorMessage.textContent = "An unexpected error occurred. Please try again.";
                console.error(error);
            }
        }
    </script>
</body>
</html>
